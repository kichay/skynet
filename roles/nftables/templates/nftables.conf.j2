#!/usr/sbin/nft -f

flush ruleset

table inet filter {

	chain input {

		type filter hook input priority 0
		policy drop
    	ct state established,related accept
	    iifname {lo, skynet} accept
    	iifname management tcp dport ssh accept
    	icmp type echo-request accept
    	tcp dport {ssh, http, https} iif {isp1, isp2} accept

	}

	chain forward {

		type filter hook forward priority 0
		policy drop
		iifname skynet accept
		iifname home oifname {isp1, isp2} accept

	}

	chain output {

		type filter hook output priority 0
		policy accept

	}

}

table ip nat {

	chain prerouting {

		type nat hook prerouting priority 0
		policy drop
		iifname home oifname {isp1, isp2} accept
		iifname skynet accept

	}

	chain postrouting {

		type nat hook postrouting priority 0
		policy drop
		oifname {isp1, isp2} masquerade

	}

}
